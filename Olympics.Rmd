```{r}
library(readr)
library(lubridate)
library(janitor)
library(tidyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(tinytex)
library(htmltools)
library(ggthemes)

athletes <- read_csv("athlete_events.csv")
noc <- read_csv("noc_regions.csv")



#KMEANS CLUSTERING FOR Height and Weight, color the points by medal.

athletes <- athletes %>% 
  filter(!is.na(Medal))

# Convert the medal type column to a factor variable
athletes$Medal <- factor(athletes$Medal) 
  
athletes <- athletes %>%
  mutate(medalInd = case_when(Medal == "Gold" ~ 1,
                   Medal == "Silver" ~ 2,
                   Medal == "Bronze" ~ 3))

# Remove any rows with missing values
athletes <- athletes[complete.cases(athletes), ]

# Filter out non-numeric variables
athletes_numeric <- athletes %>%
  select_if(is.numeric)

# Scale the numeric variables
athletes_scaled <- scale(athletes_numeric)

# Combine the scaled variables with the "Medal" column
# athletes_scaled <- cbind(athletes_scaled, athletes["Medal"])

# Perform K-means clustering with k = 3 (one for each medal type)
set.seed(123)
kmeans_result <- kmeans(athletes_scaled, centers = 3)

# Add the cluster labels to the original data
athletes$cluster <- kmeans_result$cluster

# Create a bar chart of medal counts
athletes_grouped <- athletes %>%
  group_by(medalInd) %>%
  summarize(count = sum(medalInd)/medalInd) %>%
  unique()

ggplot(athletes_grouped, aes(x = medalInd, y = count, fill = as.factor(medalInd))) +
  geom_bar(stat = "identity") +
  xlab("Medal") +
  ylab("Count") +
  ggtitle("Distribution of Medals") +
  scale_fill_manual(values = c("gold3", "gray88", "burlywood4"))
  theme_economist()


# # Visualize the clusters using ggplot
# ggplot(athletes, aes(x = variable_1, y = variable_2, color = factor(cluster))) +
#   geom_point() +
#   labs(title = "K-means Clustering for Medal Types", x = "Variable 1", y = "Variable 2", color = "Cluster")

```

