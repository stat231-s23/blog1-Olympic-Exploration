```{r, fig.height=8}
library(readr)
library(lubridate)
library(janitor)
library(tidyr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(tinytex)
library(htmltools)


athletes <- read_csv("athlete_events.csv")
noc <- read_csv("noc_regions.csv")
gdp <- read_csv("gdp_1960_2020.csv")
population <- read_csv("population_total_long.csv")


medals <- athletes %>%
  filter(!is.na(Medal))%>%
  group_by(NOC, Games)%>%
  summarise(
    Gold = sum(Medal == "Gold"),
    Silver = sum(Medal == "Silver"),
    Bronze = sum(Medal == "Bronze"))%>%
  inner_join(noc)%>%
  select(region, Games, Gold, Silver, Bronze)

usamedals <- medals %>%
  filter(region == "USA")%>%
  pivot_longer(cols = c(Gold, Silver, Bronze), names_to = "Type", values_to = "Count")%>%
  separate(Games, into = c("Year", "Season"), sep = " ")%>%
  filter(Year >= 1992)%>%
  mutate(Type = factor(Type, level = c("Gold", "Silver", "Bronze") ) )

ggplot(data = usamedals, aes(x= Year, y = Count))+
        facet_wrap(~Type)+
        geom_col(aes(fill = Season), position = "dodge")+ 
      labs(x="Year", y= "Count", title = " Medals")+
   theme(axis.text.x = element_text(angle = 90))+ ylim(c(0,160))
```
```{r}
russiamedals <- medals %>%
  filter(region == "Russia")%>%
  pivot_longer(cols = c(Gold, Silver, Bronze), names_to = "Type", values_to = "Count")%>%
  separate(Games, into = c("Year", "Season"), sep = " ")%>%
  filter(Year >= 1992)%>%
  mutate(Type = factor(Type, level = c("Gold", "Silver", "Bronze") ) )

ggplot(data = russiamedals, aes(x= Year, y = Count))+
        facet_wrap(~Type)+
        geom_col(aes(fill = Season), position = "dodge")+ 
      labs(x="Year", y= "Count", title = " Medals won by Russia")+
   theme(axis.text.x = element_text(angle = 90))+ ylim(c(0,100))

```
```{r}
germanymedals <- medals %>%
  filter(region == "Germany")%>%
  pivot_longer(cols = c(Gold, Silver, Bronze), names_to = "Type", values_to = "Count")%>%
  separate(Games, into = c("Year", "Season"), sep = " ")%>%
  filter(Year >= 1992)%>%
  mutate(Type = factor(Type, level = c("Gold", "Silver", "Bronze") ) )

ggplot(data = germanymedals, aes(x= Year, y = Count))+
        facet_wrap(~Type)+
        geom_col(aes(fill = Season), position = "dodge")+ 
      labs(x="Year", y= "Count", title = " Medals")+
   theme(axis.text.x = element_text(angle = 90))+ ylim(c(0,85))
```

